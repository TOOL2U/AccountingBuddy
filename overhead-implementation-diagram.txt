╔═══════════════════════════════════════════════════════════════════════════════╗
║                    OVERHEAD EXPENSES MODAL - IMPLEMENTATION                   ║
╚═══════════════════════════════════════════════════════════════════════════════╝

┌─────────────────────────────────────────────────────────────────────────────┐
│                              USER INTERFACE                                 │
└─────────────────────────────────────────────────────────────────────────────┘

    P&L PAGE (/pnl)
    ┌──────────────────────────────────────────────────────────────┐
    │  Month to Date                                               │
    │  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐   │
    │  │ Revenue  │  │ Overheads│  │Property/ │  │   GOP    │   │
    │  │ ฿500,000 │  │ ฿261,000 │◄─┼  Person  │  │ ฿150,000 │   │
    │  └──────────┘  └──────────┘  │ ฿89,000  │  └──────────┘   │
    │                 ▲ CLICKABLE   └──────────┘                  │
    │                 │                                            │
    │  Year to Date   │                                            │
    │  ┌──────────┐  ┌│─────────┐  ┌──────────┐  ┌──────────┐   │
    │  │ Revenue  │  │▼Overheads│  │Property/ │  │   GOP    │   │
    │  │฿6,000,000│  │฿3,132,000│◄─┼  Person  │  │฿1,800,000│   │
    │  └──────────┘  └──────────┘  │฿1,068,000│  └──────────┘   │
    │                 ▲ CLICKABLE   └──────────┘                  │
    └─────────────────┼────────────────────────────────────────────┘
                      │
                      │ onClick={() => openOverheadExpensesModal()}
                      ▼
    ┌─────────────────────────────────────────────────────────────┐
    │        OVERHEAD EXPENSES MODAL (Glass Morphism)             │
    │  ┌───────────────────────────────────────────────────────┐ │
    │  │ Overhead Expenses Breakdown                      [X]  │ │
    │  │ This Month • ฿261,000 Total                           │ │
    │  ├───────────────────────────────────────────────────────┤ │
    │  │ UTILITIES ──────────────────────────────── 3 items    │ │
    │  │  ○ Electricity              4.5% ··········· ฿11,745 │ │
    │  │  ○ Water                    2.1% ············ ฿5,481 │ │
    │  │  ○ Gas                      1.8% ············ ฿4,698 │ │
    │  │                                                        │ │
    │  │ ADMINISTRATION & GENERAL ──────────────── 5 items     │ │
    │  │  ○ Office supplies         35.2% ········· ฿92,000   │ │
    │  │  ○ Subscription/Software    1.9% ·········· ฿5,000   │ │
    │  │  ○ Professional fees        1.5% ·········· ฿3,915   │ │
    │  │  ○ Legal                    0.8% ·········· ฿2,088   │ │
    │  │  ○ License & Certificates   0.5% ·········· ฿1,305   │ │
    │  │                                                        │ │
    │  │ CONSTRUCTION ──────────────────────────── 4 items     │ │
    │  │  ○ Overheads/General        1.9% ·········· ฿5,000   │ │
    │  │  ...                                                   │ │
    │  │                                                        │ │
    │  │ [More categories: HR, Repairs, Sales...]              │ │
    │  ├───────────────────────────────────────────────────────┤ │
    │  │ 23 expense categories • 8 groups  Total: ฿261,000    │ │
    │  └───────────────────────────────────────────────────────┘ │
    └─────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────┐
│                              DATA FLOW                                      │
└─────────────────────────────────────────────────────────────────────────────┘

  1. USER CLICKS         2. STATE UPDATE      3. API CALL
     "Total Overheads"      opens modal          fetches data
          │                     │                     │
          ▼                     ▼                     ▼
    ┌──────────┐         ┌──────────┐          ┌──────────┐
    │ KPICard  │────────▶│  React   │─────────▶│   API    │
    │ onClick  │         │  State   │          │Endpoint  │
    └──────────┘         └──────────┘          └──────────┘
                              │                     │
                              │                     ▼
                              │              ┌──────────────┐
                              │              │ Google Apps  │
                              │              │   Script     │
                              │              └──────────────┘
                              │                     │
                              │                     ▼
                              │              ┌──────────────┐
                              │              │ Google Sheet │
                              │              │   Rows       │
                              │              │   29-51      │
                              │              └──────────────┘
                              │                     │
                              │                     │
                              ▼                     ▼
                        ┌─────────────────────────────┐
                        │    Modal Component          │
                        │  - Groups by category       │
                        │  - Calculates percentages   │
                        │  - Color codes values       │
                        │  - Displays formatted data  │
                        └─────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────┐
│                           FILE STRUCTURE                                    │
└─────────────────────────────────────────────────────────────────────────────┘

components/
  └── OverheadExpensesModal.tsx ················ 📄 Modal UI Component
       ├── Props: isOpen, onClose, period, totalExpense
       ├── State: data[], loading, error
       ├── useEffect: Fetches on open
       └── Renders: Grouped expense list

app/
  ├── pnl/
  │    └── page.tsx ································ 📄 P&L Dashboard Page
  │         ├── Import: OverheadExpensesModal
  │         ├── State: isOverheadModalOpen, period, total
  │         ├── Function: openOverheadExpensesModal()
  │         ├── Updated: 2 KPICard components (clickable)
  │         └── Renders: <OverheadExpensesModal />
  │
  └── api/pnl/overhead-expenses/
       └── route.ts ································ 📄 API Route Handler
            ├── GET: /api/pnl/overhead-expenses?period=month
            ├── POST: /api/pnl/overhead-expenses
            ├── Validates: period parameter
            └── Calls: Apps Script getOverheadExpensesDetails

APPS_SCRIPT_OVERHEAD_EXPENSES.js ················· 📄 Google Apps Script
  └── function getOverheadExpensesDetails(period)
       ├── Reads: P&L sheet rows 29-51
       ├── Column A: Expense names (23 rows)
       ├── Column B: This Month values
       ├── Column Q: Year Total values
       ├── Filters: "EXP -" prefix
       ├── Calculates: Percentages
       ├── Sorts: By expense amount
       └── Returns: {ok, data[], totalExpense, period}

┌─────────────────────────────────────────────────────────────────────────────┐
│                      GOOGLE SHEET DATA STRUCTURE                            │
└─────────────────────────────────────────────────────────────────────────────┘

Sheet: "P&L (DO NOT EDIT)"
Row  │ A (Name)                                    │ B (Month) │ ... │ Q (Year)
─────┼─────────────────────────────────────────────┼───────────┼─────┼─────────
 28  │ OVERHEAD EXPENSES ◄── Header                │           │     │
 29  │ EXP - Utilities - Gas                       │      0    │ ... │   4,698
 30  │ EXP - Utilities - Water                     │      0    │ ... │   5,481
 31  │ EXP - Utilities - Electricity               │      0    │ ... │  11,745
 32  │ EXP - HR - Employees Salaries               │      0    │ ... │       0
 33  │ EXP - Admin & General - License & Cert.     │      0    │ ... │   1,305
 34  │ EXP - Construction - Structure              │      0    │ ... │       0
 35  │ EXP - Construction - Overheads/General      │      0    │ ... │   5,000
 36  │ EXP - Construction - Electric Supplies      │      0    │ ... │       0
 37  │ EXP - Construction - Wall                   │      0    │ ... │       0
 38  │ EXP - Admin & General - Legal               │      0    │ ... │   2,088
 39  │ EXP - Admin & General - Professional fees   │      0    │ ... │   3,915
 40  │ EXP - Admin & General - Office supplies     │      0    │ ... │  92,000
 41  │ EXP - Admin & General - Subscription/SW     │      0    │ ... │   5,000
 42  │ EXP - Appliances & Electronics              │      0    │ ... │       0
 43  │ EXP - Windows, Doors, Locks & Hardware      │      0    │ ... │       0
 44  │ EXP - Repairs - Furniture & Decorative      │      0    │ ... │       0
 45  │ EXP - Repairs - Waste removal               │      0    │ ... │       0
 46  │ EXP - Repairs - Tools & Equipment           │      0    │ ... │       0
 47  │ EXP - Repairs - Painting & Decoration       │      0    │ ... │       0
 48  │ EXP - Repairs - Electrical & Mechanical     │      0    │ ... │       0
 49  │ EXP - Repairs - Landscaping                 │      0    │ ... │       0
 50  │ EXP - Sales & Marketing - Professional      │      0    │ ... │       0
 51  │ EXP - Other Expenses                        │      0    │ ... │       0
─────┴─────────────────────────────────────────────┴───────────┴─────┴─────────
      └─ 23 rows total

┌─────────────────────────────────────────────────────────────────────────────┐
│                         DEPLOYMENT STATUS                                   │
└─────────────────────────────────────────────────────────────────────────────┘

✅ Frontend Component   OverheadExpensesModal.tsx created
✅ API Endpoint         route.ts created  
✅ Page Integration     page.tsx updated with modal
✅ Apps Script Code     APPS_SCRIPT_OVERHEAD_EXPENSES.js ready
⏳ Apps Script Deploy   PENDING - User needs to deploy
⏳ End-to-End Test      PENDING - After Apps Script deployment

┌─────────────────────────────────────────────────────────────────────────────┐
│                              NEXT STEPS                                     │
└─────────────────────────────────────────────────────────────────────────────┘

1. Copy APPS_SCRIPT_OVERHEAD_EXPENSES.js function to Google Apps Script
2. Update doPost() to handle 'getOverheadExpensesDetails' action
3. Deploy the updated Apps Script
4. Test by clicking "Total Overheads" on P&L page
5. Verify modal opens and displays 23 expense categories
6. Check both month and year periods

╔═══════════════════════════════════════════════════════════════════════════════╗
║                              FEATURE COMPLETE                                 ║
║         Overhead Expenses now have clickable modals matching                  ║
║              the existing Property/Person modal pattern                       ║
╚═══════════════════════════════════════════════════════════════════════════════╝
